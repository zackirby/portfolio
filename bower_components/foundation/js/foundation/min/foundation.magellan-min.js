!function($,t,a,e){"use strict";Foundation.libs["magellan-expedition"]={name:"magellan-expedition",version:"5.4.7",settings:{active_class:"active",threshold:0,destination_threshold:20,throttle_delay:30,fixed_top:0},init:function(t,a,e){Foundation.inherit(this,"throttle"),this.bindings(a,e)},events:function(){var a=this,e=a.S,i=a.settings;a.set_expedition_position(),e(a.scope).off(".magellan").on("click.fndtn.magellan","["+a.add_namespace("data-magellan-arrival")+'] a[href^="#"]',function(t){t.preventDefault();var e=$(this).closest("["+a.attr_name()+"]"),i=e.data("magellan-expedition-init"),n=this.hash.split("#").join(""),o=$("a[name='"+n+"']");0===o.length&&(o=$("#"+n));var s=o.offset().top-i.destination_threshold+1;s-=e.outerHeight(),$("html, body").stop().animate({scrollTop:s},700,"swing",function(){history.pushState?history.pushState(null,null,"#"+n):location.hash="#"+n})}).on("scroll.fndtn.magellan",a.throttle(this.check_for_arrivals.bind(this),i.throttle_delay)),$(t).on("resize.fndtn.magellan",a.throttle(this.set_expedition_position.bind(this),i.throttle_delay))},check_for_arrivals:function(){var t=this;t.update_arrivals(),t.update_expedition_positions()},set_expedition_position:function(){var t=this;$("["+this.attr_name()+"=fixed]",t.scope).each(function(a,e){var i=$(this),n=i.data("magellan-expedition-init"),o=i.attr("styles"),s,l;i.attr("style",""),s=i.offset().top+n.threshold,l=parseInt(i.data("magellan-fixed-top")),isNaN(l)||(t.settings.fixed_top=l),i.data(t.data_attr("magellan-top-offset"),s),i.attr("style",o)})},update_expedition_positions:function(){var a=this,e=$(t).scrollTop();$("["+this.attr_name()+"=fixed]",a.scope).each(function(){var t=$(this),i=t.data("magellan-expedition-init"),n=t.attr("style"),o=t.data("magellan-top-offset");if(e+a.settings.fixed_top>=o){var s=t.prev("["+a.add_namespace("data-magellan-expedition-clone")+"]");0===s.length&&(s=t.clone(),s.removeAttr(a.attr_name()),s.attr(a.add_namespace("data-magellan-expedition-clone"),""),t.before(s)),t.css({position:"fixed",top:i.fixed_top}).addClass("fixed")}else t.prev("["+a.add_namespace("data-magellan-expedition-clone")+"]").remove(),t.attr("style",n).css("position","").css("top","").removeClass("fixed")})},update_arrivals:function(){var a=this,e=$(t).scrollTop();$("["+this.attr_name()+"]",a.scope).each(function(){var t=$(this),i=t.data(a.attr_name(!0)+"-init"),n=a.offsets(t,e),o=t.find("["+a.add_namespace("data-magellan-arrival")+"]"),s=!1;n.each(function(e,n){if(n.viewport_offset>=n.top_offset){var o=t.find("["+a.add_namespace("data-magellan-arrival")+"]");return o.not(n.arrival).removeClass(i.active_class),n.arrival.addClass(i.active_class),s=!0,!0}}),s||o.removeClass(i.active_class)})},offsets:function(t,a){var e=this,i=t.data(e.attr_name(!0)+"-init"),n=a;return t.find("["+e.add_namespace("data-magellan-arrival")+"]").map(function(a,o){var s=$(this).data(e.data_attr("magellan-arrival")),l=$("["+e.add_namespace("data-magellan-destination")+"="+s+"]");if(l.length>0){var r=Math.floor(l.offset().top-i.destination_threshold-t.outerHeight());return{destination:l,arrival:$(this),top_offset:r,viewport_offset:n}}}).sort(function(t,a){return t.top_offset<a.top_offset?-1:t.top_offset>a.top_offset?1:0})},data_attr:function(t){return this.namespace.length>0?this.namespace+"-"+t:t},off:function(){this.S(this.scope).off(".magellan"),this.S(t).off(".magellan")},reflow:function(){var t=this;$("["+t.add_namespace("data-magellan-expedition-clone")+"]",t.scope).remove()}}}(jQuery,window,window.document);